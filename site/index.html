<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Formulario de contacto</title>
</head>
<body>
  <h1>Enviar mensaje privado</h1>
  <textarea id="mensaje" placeholder="Escribe tu mensaje..."></textarea><br><br>
  <button onclick="sendEmail()">Enviar AUTOMÁTICO por Email</button>
  <button onclick="abrirGmail()">Abrir Gmail</button>
  <button onclick="abrirWa()">Abrir WhatsApp</button>

  <script>
  const DEST_EMAIL = "alexbargesrj@gmail.com";
  const DEST_WA = "5521983889456";
  function getMsg(){ return document.getElementById('mensaje').value || ''; }

  async function sendEmail(){
    try{
      const res = await fetch('/api/send-email', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          to: 'alexbargesrj@gmail.com',   // destinatario
          subject: 'Mensaje desde el formulario',
          message: getMsg()
        })
      });
      const txt = await res.text();
      alert(res.ok ? 'Enviado ✅' : `Error: ${txt}`);
    }catch(e){
      alert('Error: ' + e.message);
    }
  }

  function abrirGmail(){
    const url = `https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(DEST_EMAIL)}&su=Mensaje&body=${encodeURIComponent(getMsg())}`;
    window.open(url, "_blank");
  }

  function abrirWa(){
    const url = `https://wa.me/${DEST_WA}?text=${encodeURIComponent(getMsg())}`;
    window.open(url, "_blank");
  }
</script>

</body>
</html>
